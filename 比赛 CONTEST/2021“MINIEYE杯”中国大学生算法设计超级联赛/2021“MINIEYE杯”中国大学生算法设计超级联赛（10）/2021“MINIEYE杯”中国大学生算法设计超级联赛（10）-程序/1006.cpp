#include<bits/stdc++.h>
#define fo(i, x, y) for(int i = x, _b = y; i <= _b; i ++)
#define ff(i, x, y) for(int i = x, _b = y; i <  _b; i ++)
#define fd(i, x, y) for(int i = x, _b = y; i >= _b; i --)
#define ll long long
#define pp printf
#define hh pp("\n")
using namespace std;

#define ui unsigned int

const int N = 2e6 + 5;

int p[N], p0, bz[N], phi[N];

void sieve(int n) {
	phi[1] = 1;
	fo(i, 2, n) {
		if(!bz[i]) p[++ p0] = i, phi[i] = i - 1;
		for(int j = 1; i * p[j] <= n; j ++) {
			int k = i * p[j]; bz[k] = 1;
			if(i % p[j] == 0) {
				phi[k] = phi[i] * p[j];
				break;
			}
			phi[k] = phi[i] * phi[p[j]];
		}
	}
}

ll gcd(ll x, ll y) {
	return !y ? x : gcd(y, x % y);
}

struct P {
	ll x, y;
} d[1200000]; int d0;
ui s[1200000];

int cmp(P a, P b) { return a.x < b.x;}

void build() {
	int n = ceil(pow(2e18, (double) 1 / 3));
	fo(i, 1, n) {
		ll x = (ll) i * (i + 1), y = (ll) phi[i] * phi[i + 1];
		fo(j, i + 2, 1e9) {
			int d1 = gcd(x, j);
			int k = j / d1;
			if(1e18 / k < x) break;
			int d2 = gcd(x, k);
			y = y * phi[k] / phi[d2] * d2;
			x *= k;
			d[++ d0] = (P) {x, y};
		}
	}
	sort(d + 1, d + d0 + 1, cmp);
	fo(i, 1, d0) s[i] = s[i - 1] + d[i].y;
}
ui qry(ll n) {
	int as = 0;
	for(int l = 1, r = d0; l <= r; ) {
		int m = l + r >> 1;
		if(d[m].x <= n) as = m, l = m + 1; else r = m - 1;
	}
	return s[as];
}

ui tbl[1001] = {0, 2298992963,20737083,513597167,1721646463,2806397395,2802122835,1485983503,3091413427,4208310523,2831606407,1628710319,2817038135,928385067,3863807535,3676485623,767875647,2313059015,1137679023,396967215,2304634307,2890862199,90066623,558603471,1679200987,3911243011,982845519,1670422743,4093650807,2151241015,863633819,1914418175,1180229931,890457979,2725678339,1513164495,716799111,1262781239,3686770103,1121843051,1078090151,834258119,418144215,1591360999,1780791579,174116147,3241891131,1141318943,997398119,3250717543,3114793999,3706497599,2037260823,3040210079,1305807835,1723687815,1135940691,3314489459,949356871,3081495243,594017127,1622159175,1224816023,1859397967,2147536439,2490547939,2745824391,3569126119,209337115,1385386507,3287781831,1511510295,284723135,4085720447,2725134651,3013309179,71441799,1556277167,3658898795,1085308915,1678514911,3456120263,546233879,2496369755,193275419,4282361863,3775550443,4285664399,2099488911,2628534215,2432263179,3468160367,1671973155,2938398207,3540562715,3610544975,2888893179,289531399,3114637431,518482127,2262440907,3616476143,2966216843,4251779999,4063592799,3698910747,1227503963,3503973859,3549089463,2110776455,3619754571,1083848987,511566439,2400343107,509034383,719893503,736382147,2821535951,4251845767,24346707,1239781443,342252751,2529639107,2189157819,1693232319,740767787,1791916739,1765663095,3156691819,1991340499,958996291,2135223311,2360682779,1586995451,3434584923,2940990079,3418758963,1372936207,2361497419,3062180695,208618619,1725733583,2796042723,2487121779,2082226923,1299273727,2383364727,2507532991,2064075831,2887773999,91937839,2345075095,1160117815,1279637083,3022557379,570839187,2230177543,4006750547,3932849719,1617229291,3249563659,2877452527,1439624795,1425145927,4241556719,2877537811,360631835,3147736067,2510674783,342347975,1421385619,3768199279,1318995403,3263133419,1305990095,3181020099,3472685135,744958171,2157270675,1758501899,4258829695,116770123,1891184931,3632605511,3405999467,2858780831,3030614027,2752130379,1087607031,3350849903,587682867,3301124123,4211664671,2369171623,3587401147,3947184935,516717579,3742202675,1851980795,227105651,1391894051,3260881755,1009078155,2802669691,4033409119,433501371,4206426979,3379776495,4153948811,644090875,4243668359,988525183,1811852355,2466848203,3084493955,205252071,4229791387,1831448975,3735604355,867719339,1774274559,1823165563,1632967647,1972451915,3255949783,2722118247,2123587763,1799455635,3441860939,693811531,4040594327,1742319319,2831120575,135486615,1559567959,1039915323,3023152723,251345179,148567,561704047,1355954615,774087803,3389528703,3172982151,2010490411,682459251,831882811,894211647,485954151,1232061267,2425232455,2082951859,2856803571,3663214727,951129247,1740109903,132967471,1617389483,1786056099,1957601263,307243539,1674840935,2545534311,345789087,40261811,2618050483,4175315647,3355004779,2940366139,3242406531,3578944239,3813672983,3459271219,22162063,459733307,3379387139,3590111659,825938783,2159217487,1316209887,996150787,890431487,4262164051,1214711407,1816814699,2335696871,2880406955,711958555,2719959847,2084011139,4261913603,1509182503,1304818507,3083699111,2921789095,4059129203,2261760407,1019563015,691014667,1906147835,1293438347,869348659,1407176107,1069531619,4254787791,4134886535,1373096587,2096955731,4094999907,690372671,1453114163,4028140907,1641215219,1350582919,4065335079,1534430891,518110787,2903886559,1413585223,3780207603,1087524403,267967491,2274571987,317454635,1324996979,1603459087,3785641383,2015622987,2757435339,2566602983,437354795,1244832131,4082921635,1279038511,3109649059,3956011511,3729148359,4006633543,2269454211,3100998907,3679214471,3567774563,1390545435,3722311443,1618760531,4263609743,1878156847,3496278231,3462553203,3935173651,815165179,2364603439,3056554631,3292704623,1935625451,913462431,768192155,3425228515,2531263131,3466160667,393912671,1216565991,3927150203,3959205303,2068956867,2839465691,3755156651,2713597355,3787241259,2296682235,3640042063,2998070943,759656435,3110694359,3503100635,3450134095,2575894791,159914251,4243956503,567405463,233418683,3518999711,579176879,4275154795,809789459,3542304003,2086175627,273000439,3133213731,3004848287,3398657631,2016671219,3199768015,1893875655,14853507,71338819,1863272287,2168945379,2546033459,1359997375,2142916243,2271557579,147465163,4129300455,3176739887,748664399,4007139707,3552421535,3377517603,1916734431,154486351,639997259,2318596467,2650661439,880545171,1373252063,1181523847,539868359,2746625087,3433227679,1129816391,4231348283,136905363,1037136787,2955894967,1287022619,2597542539,137931507,1380487135,2723278723,2047412999,2868363691,3484052783,1873140843,100908955,1357269667,731950535,2473250863,3131911443,2332831151,3460816211,2484543219,1757051979,4131685919,964586567,1491285039,2043301583,1022473039,3760969783,1339500983,793695803,2389607883,27021503,811344423,3768866691,1475327619,1537286715,928074503,920200651,1345655299,3652588403,2719602327,1380240035,1965531495,2029875511,2924974999,4036335655,1087524587,2165394963,4003451291,1479514511,381466771,1870885027,1441016415,1878239283,1068056663,3112319919,1412949931,2963965167,3920140127,171582467,2256369035,4122074907,2694373175,1996786523,2270411423,3174163271,2874411583,106757447,3239387103,3907239579,4207727003,4030947407,1383952795,1150338279,2545698731,2272496159,687969107,4134521323,3108649663,3200292007,659716963,2075117831,640342235,274215331,2081372775,3617568015,3404302363,731879075,1643428895,3797615119,2870549439,177581563,3236858451,2246737003,2984110335,1663474831,163582899,1146596991,2929724191,2373264991,4154828407,3269559475,1648396579,2604009939,2125905063,3199930127,3852996587,2647886839,3189753023,1571583591,179995943,585830579,4110245259,4093758547,3840380751,769505107,4028728695,1857689667,2754615215,4200375427,3394239015,1915150747,917880031,1116941215,762735727,2688364067,536358899,1448960639,3873544039,3111855623,2059627635,2118688135,1095427123,2786290667,2227284839,1065489927,300508263,217263015,1965532363,1345493259,2106698463,806804979,3324239447,3532560043,1877703595,3126131995,1185144379,1822913023,375985031,3888797751,301865295,2327875939,280603419,2150203883,1899477827,2453635715,4210793479,1392572831,3671316987,4031741819,1005088607,263849407,1357966923,1763681923,2844118839,1389549243,3328892619,4268972667,1275429119,622784523,162478771,305516291,251542735,1093471599,2021624271,2592797463,663454467,4225009607,844761039,2445117527,4008735419,1081352511,2921013895,3809959799,3139127099,4221682995,3743369327,402177411,672237707,403776223,3624409531,3466972627,2005484183,2532965591,3865638579,1041130615,1874038915,1811287379,2254730695,508811767,595992999,4108318087,3625298875,630359535,475749255,3194086415,2099453967,1097882715,1972564059,3079957091,3216907907,2904136543,484634527,1297091459,1019866439,1213745255,3007335523,1022131879,3874779863,1040940119,593550247,3555293967,1394063003,924071791,657194179,3962472595,3352620527,1294872159,1370862063,3634560027,1103517803,1107958643,349124207,847127883,2312199671,2893449619,2506659971,3898131515,1249835079,2912291795,3182501363,4276031491,3320300723,3691841651,1151591783,1325770763,2470024743,469963155,4228332827,1667500119,4084457323,2954667663,2451322947,2313918667,3635948819,1580073807,1795564507,3619994167,1251831707,1615220455,3476126023,2122468015,3670871487,3329389339,385609819,490508091,310474559,2419444695,3320962171,96171267,2486568823,148622599,2561244099,524390267,2066148279,4055946611,4012783139,99197491,1211541039,2921074371,3793303943,3716259839,3570887107,557336387,540761783,2600425811,3002405967,1073020715,1409510215,2828661819,2506318903,1904582739,3282820943,2784185047,2428315727,2292692887,4080760243,633896999,3984255811,1370050819,4063421839,1788241543,1110225231,2676295171,2458314115,1928213115,2284988875,3535586767,1057234903,591661063,1894884767,2494178843,4131087471,3812370251,575641527,3239624555,373227219,510717655,1433936423,2701373839,1293211495,3374884383,994993535,1067694355,4249866667,1894009439,1740567619,2189724879,2868799811,3463490855,32048823,1677023555,1013572327,2029582383,175190891,151630511,3326102735,3985817027,2331579159,1049624839,3681904483,696652263,935651391,1506444955,1566775363,1370525479,2234560803,130341331,3244166311,1680156607,254674911,1471925779,2063801675,1408211159,112690999,3726065451,208188551,793973151,225793343,2935502599,3364863203,2820608039,2375328423,458675491,3430774799,59616611,2482356927,2842702655,3275885799,3208825903,59710187,1133360107,3974203911,2297973847,2743180827,889159483,2327345111,1153331607,3007667683,3565352887,2441783259,1811481559,1073529675,3890109487,589265523,3269380031,1862105995,2309457555,2085309219,893056351,2319099575,1278856675,2375613611,1794653915,1159975135,2541638007,746129151,1591511735,2560819303,3977388191,3251906975,3952267947,1895404811,584274759,1637408751,2690854327,407309739,1620754527,2905764403,4281873443,48400619,3358724631,488252199,3078677691,760323355,2880427763,2733775119,3491913543,2079506659,217997511,3528633659,3989811275,3296502011,176098511,2102501007,2928407091,227350339,2577031031,382456547,744074255,2866991583,2891639719,3589629095,3222774439,809307903,1001988503,1287723395,1346225471,1392114043,3890570475,755060299,1444249943,2036157443,1335387139,340149119,4170117775,1301165967,2123611343,3641271703,898389363,3802026723,1350710175,2672619559,1884231803,3323840455,2540403623,1119355175,312932375,4178372695,1525272155,687494271,3459204655,3274511059,978871771,1605383191,3567165915,2389230131,1006314651,2251222499,1727036151,3236185863,3254384839,109194127,506372019,1353184843,2398697359,2716666863,3287464503,1276004047,672567347,3626206259,4163203087,1882450699,3093259631,2361324411,2198462611,3133881987,327591739,3822482575,3746165807,440729127,807417139,3686803151,1227922575,3766340403,1114725911,951122595,2821531383,1913888339,143123907,2137441143,1758430727,1036984595,3560492679,2597477535,749944867,697623039,606760631,109427875,2256825187,442399595,3325133979,3247779083,1428587863,1007273943,2775212219,3625840443,1326343539,3065712311,2335827259,3491775539,2523097995,706646891,116465407,390801527,1426390187,716811375,3542005755,2573833059,4038479543,757384163,1319256883,1458179955,2238226051,1350921335,1241418267,2765170219,2820486863,3124801027,1813938967,2335965495,3708404463,2742434715,361230271,1292997787,153340575,1362035371,241705115,770720355,1654726463,3003642783,4078430667,293560547,311264731,3078071995,996512951,2010703095,159333415,4254455419,1560979811,4059120723,1664689803,873247267,2781020471,1565811127,4026313927,2711484387,2266588631,1015494539,3704029883,2045552927,787304779,1236390259,930877111,2356549855,2554649471,3420025347,1583360051,502995971,2381314331};

const int W = 1e6;

namespace sub1 {
	int d[W + 5], n, t[W + 5];
	void get_tab(int l, int r) {
		fo(i, 0, r - l) d[i] = l + i, t[i] = 1;
		for(int i = 1; p[i] * p[i] <= r; i ++) {
			int w = p[i];
			int st = l - 1 - ((l - 1) % w) + w;
			for(int x = st; x <= r; x += w) {
				int y = x - l;
				d[y] /= w; t[y] *= (w - 1);
				while(d[y] % w == 0) {
					d[y] /= w; t[y] *= w;
				}
			}
		}
		fo(i, 0, r - l) if(d[i] > 1)
			t[i] *= d[i] - 1;
		if(l == 0) t[0] = 0;
	}
}

ui work(int n) {
	int m = n / W * W;
	ui ans = tbl[n / W];
	sub1 :: get_tab(m, n);
	fo(i, 1, n - m) ans += (ui) sub1 :: t[i - 1] * sub1 :: t[i];
	return ans;
}

ui solve(ll n) {
	if(!n) return 0;
	ui ans = qry(n);
	int x = sqrt(n) + 1;
	while((ll) x * (x - 1) > n) x --;
	return ans + work(x);
}

int T;
ll L, R;

int main() {
//	freopen("a.in", "r", stdin);
	sieve(2e6);
	build();
	for(scanf("%d", &T); T; T --) {
		scanf("%lld %lld", &L, &R);
		pp("%u\n", solve(R) - solve(L - 1));
	}
}
